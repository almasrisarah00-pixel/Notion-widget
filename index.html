<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Daily Magic Card</title>
  <style>
    body {
      margin: 0;
      padding: 1rem;
      font-family: sans-serif;
      background: #f8f8f8;
      text-align: center;
    }
    img {
      max-width: 100%;
      height: auto;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }
  </style>
</head>
<body>
  <h3>Daily MTG Card</h3>
  <div id="card-container">Loading...</div>

  <script>
    async function getDailyCard() {
      const today = new Date();
      const seed = today.toISOString().slice(0, 10); // YYYY-MM-DD

      // Simple hash function
      let hash = 0;
      for (let i = 0; i < seed.length; i++) {
        hash = seed.charCodeAt(i) + ((hash << 5) - hash);
        hash |= 0; // Convert to 32bit integer
      }

      const pageSize = 175;
      const totalCards = 25000; // Rough estimate
      const cardIndex = Math.abs(hash) % totalCards;

      const page = Math.floor(cardIndex / pageSize) + 1;

      try {
        const response = await fetch(`https://api.scryfall.com/cards/search?q=*&order=set&unique=cards&page=${page}`);
        const data = await response.json();

        if (!data.data || data.data.length === 0) {
          document.getElementById('card-container').innerText = 'No cards found.';
          return;
        }

        const card = data.data[cardIndex % pageSize];

        if (card && (card.image_uris || (card.card_faces && card.card_faces[0].image_uris))) {
          // Some cards have multiple faces, like double-faced cards
          const imageUrl = card.image_uris ? card.image_uris.normal : card.card_faces[0].image_uris.normal;

          document.getElementById('card-container').innerHTML = `
            <img src="${imageUrl}" alt="${card.name}" />
            <p>${card.name}</p>
          `;
        } else {
          document.getElementById('card-container').innerText = 'Card image not available.';
        }
      } catch (e) {
        console.error(e);
        document.getElementById('card-container').innerText = 'Error loading card.';
      }
    }

    getDailyCard();
  </script>
</body>
</html>
