<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Daily Magic Card</title>
  <style>
    body {
      margin: 0;
      padding: 1rem;
      font-family: sans-serif;
      background: #f8f8f8;
      text-align: center;
    }
    img {
      max-width: 100%;
      height: auto;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }
  </style>
</head>
<body>
  <h3>Daily MTG Card</h3>
  <div id="card-container">Loading...</div>

  <script>
    // Basic deterministic PRNG using sine function
    function seededRandom(seed) {
      const x = Math.sin(seed) * 10000;
      return x - Math.floor(x);
    }

    // Create a unique seed for each date (based on local time)
    function getSeedFromDate() {
      const today = new Date();
      const y = today.getFullYear();
      const m = today.getMonth() + 1; // Month is zero-based
      const d = today.getDate();
      return y * 10000 + m * 100 + d; // e.g., 20250804
    }

    async function getDailyRandomCard() {
      const seed = getSeedFromDate();
      const rand = seededRandom(seed);

      const pageSize = 175;
      const totalCards = 25000;
      const cardIndex = Math.floor(rand * totalCards);

      const page = Math.floor(cardIndex / pageSize) + 1;
      const position = cardIndex % pageSize;

      try {
        const response = await fetch(`https://api.scryfall.com/cards/search?q=*&order=set&unique=cards&page=${page}`);
        const data = await response.json();

        if (!data || !data.data || !data.data[position]) {
          document.getElementById('card-container').innerText = 'Card not found.';
          return;
        }

        const card = data.data[position];

        const imageUrl = card.image_uris?.normal || card.card_faces?.[0]?.image_uris?.normal;

        if (imageUrl) {
          document.getElementById('card-container').innerHTML = `
            <img src="${imageUrl}" alt="${card.name}" />
            <p>${card.name}</p>
          `;
        } else {
          document.getElementById('card-container').innerText = 'Image not available.';
        }
      } catch (e) {
        console.error(e);
        document.getElementById('card-container').innerText = 'Error loading card.';
      }
    }

    getDailyRandomCard();
  </script>
</body>
</html>
